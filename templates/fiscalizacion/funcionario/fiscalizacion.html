{% extends "base_funcionario.html" %}
{% load filtros_solicitudes %}
{% load filtros_datos %}
{% load widget_tweaks %}
{% load i18n %}
{% block css %}
    {{ block.super }}
    <style>
        #editar-acta-reparo-modal table tr td,
        #editar-acta-reparo-modal table tr th,
        #nueva-acta-reparo-modal table tr td,
        #nueva-acta-reparo-modal table tr th {
            vertical-align: middle !important;
        }
    </style>

{% endblock %}

{% block javascripts %}
    {{ block.super }}
    <script src="{{ STATIC_URL }}js/helpers.js"></script>
    <script type="text/javascript">
        //FIXME
        $(document).ready(function () {
            $('.fecha').datepicker({
                format: "dd/mm/yyyy",
                language: "es",
                autoclose: true
            });
        });
    </script>
{% endblock %}

{% block main_content %}

    <div ng-controller="FiscalizacionCtrl">
    <!-- Right side column. Contains the navbar and content of the page -->
    <aside class="right-side">
    <section class="content-header">
        <h1> Fiscalización
            <small>{{ fiscalizacion.pst.razon_social }}</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-edit"></i> Fiscalización</a></li>
            <li class="active">{{ fiscalizacion.pst.razon_social }}</li>
        </ol>
    </section>
    <!-- Main content -->
    <section class="content">

    <div class="box box-danger">
    <div class="box-body">
    <!-- Begin datos de la Fiscalización -->
    <div class="row">
        <div class="col-xs-12">
            <div class="title">Fiscalización</div>
        </div>
    </div>

    <div class="row hidden">
        <div class="col-xs-4 text-right">
            <label>Código de fiscalización</label>
        </div>
        <div class="col-xs-8">
            <span id="codigo_objeto" data-codigo='{{ fiscalizacion.id }}'>{{ fiscalizacion.id }}</span>
        </div>
        <div class="col-xs-3"></div>
    </div>
    <div class="row">
        <div class="col-xs-4 text-right">
            <label class="labelmodal">Período de fiscalización:</label>
        </div>
        <div class="col-xs-8">
            <span>
                {% language 'es' %}
                    {{ fiscalizacion.desde }} al {{ fiscalizacion.hasta }}
                {% endlanguage %}
            </span>
        </div>
    </div>
    <!-- Begin datos de la fiscalizacion -->

    <!-- Begin datos del pst -->
    <div class="row">
        <div class="col-xs-12">
            <div class="title"> Datos de PST
                <div class="col-xs-3 pull-right">
                    <a href="#" class="btn btn-primary btn-block btn-flat btn-add">
                        Ver expediente
                        <i class="fa fa-search btn-icon icon-white"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-4 text-right">
            <label class="labelmodal">RIF:</label>
        </div>
        <div class="col-xs-4">
            <span id="pst-rif">{{ fiscalizacion.pst.rif }}</span>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-4 text-right">
            <label class="labelmodal">Razón social:</label>
        </div>
        <div class="col-xs-4">
            <span>{{ fiscalizacion.pst.razon_social }}</span>
        </div>
    </div>
    {% if fizcalizacion.pst.tipo_figura == 1 %}
        <div class="row">
            <div class="col-xs-4 text-right">
                <label class="labelmodal">Denominación comercial:</label>
            </div>
            <div class="col-xs-4">
                <span>{{ fizcalizacion.pst.denominacion_comercial }}</span>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-4 text-right">
                <label class="labelmodal">Tipo de persona jurídica:</label>
            </div>
            <div class="col-xs-4">
                <span>{{ fizcalizacion.pst|get_tipo_pst }}</span>
            </div>
        </div>
    {% endif %}
    <div class="row">
        <div class="col-xs-4 text-right">
            <label class="labelmodal">Fecha de registro:</label>
        </div>
        <div class="col-xs-4">
            <span class="labelmodal">{{ fiscalizacion.pst.creado_el }}</span>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-4 text-right">
            <label class="labelmodal">Última verificación:</label>
        </div>
        <div class="col-xs-4">
            <span>{{ fiscalizacion.pst.ultima_verificacion|default:"-" }}</span>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-4 text-right">
            <label class="labelmodal">Última fiscalización:</label>
        </div>
        <div class="col-xs-4">
            <span>{{ fiscalizacion.pst.ultima_fiscalizacion|default:"-" }}</span>
        </div>
    </div>
    <!-- End datos del pst -->

    <!-- Begin Funcionarios actuantes -->
    <div class="row">
        <div class="col-xs-12">
            <div class="title">
                Funcionarios actuantes
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <table class="table table-striped">
                <thead>
                <tr>
                    <th class="">Cédula</th>
                    <th class="">Credencial</th>
                    <th class="">Nombres</th>
                    <th class="">Apellidos</th>
                    <th class="">Tipo asignacion</th>
                </tr>
                </thead>
                <tbody>
                {% for funcionario in funcionarios %}
                    <tr>
                        <td class="">{{ funcionario.funcionario.rif }}</td>
                        <td class="">{{ funcionario.funcionario.rif }}</td>
                        <td class="">{{ funcionario.funcionario.nombres }}</td>
                        <td class="">{{ funcionario.funcionario.apellidos }}</td>
                        <td class="">
                            {% if funcionario.es_apoyo %} Apoyo {% endif %}
                            {% if funcionario.es_coordinador %} Coordinador {% endif %}
                            {% if not funcionario.es_coordinador and not funcionario.es_apoy %} Funcionario {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <!-- End Funcionarios actuantes -->
    <br/>

    <!-- Documentos de actuacion -->
    <div class="row">
        <div class="col-xs-12">
            <div class="title">
                Documentos de actuación
                <div class="col-xs-3 col-lg-3 pull-right hidden">
                    <a href="#" class="btn btn-success btn-block btn-flat btn-add">
                        Imprimir documentos de actuación
                        <i class="fa fa-print btn-icon icon-white"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <table class="table table-striped">
                <thead>
                <tr>
                    <th class="">Documentos</th>
                    <th class="">Número de documento</th>
                    <th>Fecha Notificación</th>
                    <th class="">Estatus</th>
                    <th class="text-center">Opciones</th>
                </tr>
                </thead>
                <tbody>
                {% for documento in documentos %}
                    <tr data-pk="{{ documento.pk }}">
                        <td class="" id="{{ documento.id }}" data-tipo="{{ documento.tipo.nombre }}"
                            data-codigo="{{ documento.codigo }}">{{ documento.tipo.nombre }}</td>
                        <td class="">{{ documento.codigo }}</td>
                        {% if documento.fecha_notificacion %}
                            <td class="">{{ documento.fecha_notificacion }}</td>
                        {% else %}
                            <td class="">-------------------------</td>
                        {% endif %}

                        <td class="">
                            <small
                                    class="
                                    label{% if documento.estatus == 2 %}
                                            label-success
                                         {% else %}
                                            label-warning
                                         {% endif %}
                                    ">
                                {{ documento.get_estatus_display }}
                            </small>
                        </td>
                        <td>
                            <div class="row">
                                <!--si no esta anulada la providencia, entonces muestra el boton eliminar -->
                                {% if documento.estatus != 4 %}
                                    {% if documento.tipo.nombre == 'Providencia' %}
                                        <div class="col-xs-3">
                                            <a class="btn btn-danger"
                                               data-toggle="modal"
                                               data-target="#anular_providencia"
                                               ng-click="anular_providencia('{{ documento.codigo }}')">
                                                <i class="fa fa-trash-o icon-white"
                                                   alt="Solicitar anulacion"></i>
                                            </a>
                                        </div>
                                    {% else %}
                                        <div class="col-xs-3">
                                            <a class="btn btn-danger"
                                               href="{% url 'eliminar_nueva_acta_fiscalizacion' pk=documento.id pk_fiscalizacion=fiscalizacion.id %}"
                                               title="Delete"
                                               data-toggle="modal"
                                               data-target="#myModal">
                                                <i class="fa fa-trash-o icon-white"
                                                   alt="Eliminar acta"></i>
                                            </a>
                                        </div>
                                    {% endif %}
                                {% else %}
                                    <div class="col-xs-3"></div>
                                {% endif %}
                                {% if documento.mostrar_boton_solicitud %}
                                  <div class="col-xs-3">
                                      <a class="btn btn-info" data-toggle="modal" data-target="#editar-acta-reparo-modal">
                                        <i class="fa fa-edit icon-white"></i>
                                      </a>
                                  </div>
                                  {% else %}
                                  <div class="col-xs-3">
                                      <a class="btn btn-info" ng-click="editar('{{ documento.id }}')">
                                          <i class="fa fa-edit icon-white"></i>
                                      </a>
                                  </div>
                                {% endif %}
                                <div class="col-xs-3">
                                    <a class="btn btn-primary"
                                       ng-click="ver('{{ documento.id }}')">
                                        <i class="fa fa-search icon-white"></i>
                                    </a>
                                </div>
                                {% if documento.mostrar_boton_solicitud %}
                                    <div class="col-xs-3" ng-controller="AprobacionActaReparoCtrl">
                                      <a href="#" class="btn btn-success" ng-click="solicitar($event, {{ documento.pk }})">
                                          <i class="fa fa-check-square icon-white"></i>
                                        </a>
                                    </div>
                                  {% else %}
                                    <div class="col-xs-3">
                                        <a href="{% url 'fiscalizacion_pdf' documento.id %}"
                                           class="btn btn-success">
                                            <i class="fa fa-print icon-white"></i>
                                        </a>
                                    </div>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                {% endfor %}

                <tr>
                    <td class="" colspan="5">
                        <div class="row">
                            <div class="col-xs-6">
                                <select class="select"
                                        ng-model="item"
                                        ng-change="agregar(item)"
                                        ng-init="item='Seleccione tipo de documento'">
                                    <option>Seleccione tipo de documento</option>
                                    {% for tipo in tipos_de_actas %}
                                        {% if tipo.nombre %}
                                            <option>{{ tipo.nombre }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-xs-6" ng-if="valido == true">
                                <div ng-if="tiene_requisitos == true">
                                    <a href="#" class="btn btn-primary btn-flat btn-block" data-toggle="modal"
                                       data-target="#agregar_acta_cerrada">
                                        Agregar acta
                                        <i class="fa fa-plus btn-icon icon-white"></i>
                                    </a>
                                </div>
                                <div ng-if="tiene_requisitos == false">
                                    <a href="#" class="btn btn-primary btn-flat btn-block" data-toggle="modal"
                                       data-target="#agregar_acta">
                                        Agregar acta
                                        <i class="fa fa-plus btn-icon icon-white"></i>
                                    </a>
                                </div>
                            </div>
                            <div class="col-xs-6" ng-if="valido != true">
                                <a href="#" class="btn btn-primary btn-flat btn-block" data-toggle="modal"
                                   data-target="#advertencia_seleccionar_acta">
                                    Agregar acta
                                    <i class="fa fa-plus btn-icon icon-white"></i>
                                </a>
                            </div>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <!-- End Documentos de actuacion -->

    {% if fiscalizacion.estatus != 2 %}
        <div class="row" style="margin-top: 2em;">
            <div class="col-xs-6 col-lg-5 col-lg-offset-1">
                <a href="{% url 'funcionario_fiscalizaciones' %}" class="btn btn-info btn-flat btn-block">
                    <span class="fa fa-arrow-circle-o-left btn-icon-back"></span> Volver
                </a>
            </div>

            <div class="col-xs-6 col-lg-5">
                <button class="btn btn-flat btn-block btn-primary" data-toggle="modal"
                        data-target="#fiscalizacion-concluir-modal">
                    Concluir
                </button>
            </div>
        </div>
    {% elif resolucion %}
        <div class="row">
            <div class="col-xs-12">
                <div class="title">Resolución de Imposición de Sanciones</div>
            </div>
        </div>

        <div class="row">
            <div class="col-xs-12">
                <table class="table table-striped text-center">
                    <thead>
                    <tr>
                        <th>Número de Resolución</th>
                        <th>Estatus</th>
                        <th colspan="3">Opciones</th>
                    </tr>
                    </thead>

                    <tbody>
                    <tr class="resolucion">
                        <td>{{ resolucion.numero_documento }}</td>
                        <td><span class="badge bg-green">{{ resolucion.estatus }}</span></td>
                        <td>
                            <button class="btn btn-info btn-block btn-flat editar" data-pk="{{ resolucion.pk }}">
                                Editar <span class="fa fa-edit"></span>
                            </button>
                        </td>
                        <td>
                            <button class="btn btn-primary btn-block btn-flat solicitar-aprobacion"
                                    data-pk="{{ resolucion.pk }}">
                                Solicitar Aprobación <span class="fa fa-check"></span>
                            </button>
                        </td>
                        <td>
                            <button class="btn btn-danger btn-block btn-flat borrar" data-pk="{{ resolucion.pk }}">
                                Borrar <span class="fa fa-trash-o"></span>
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="row" style="margin-top: 2em;">
            <div class="col-xs-12 col-lg-10 col-lg-offset-1">
                <a href="{% url 'funcionario_fiscalizaciones' %}" class="btn btn-info btn-flat btn-block">
                    <span class="fa fa-arrow-circle-o-left btn-icon-back"></span> Volver
                </a>
            </div>
        </div>
    {% else %}
        <div class="row" style="margin-top: 2em;">
            <div class="col-xs-12 col-lg-10 col-lg-offset-1">
                <a href="{% url 'funcionario_fiscalizaciones' %}" class="btn btn-info btn-flat btn-block">
                    <span class="fa fa-arrow-circle-o-left btn-icon-back"></span> Volver
                </a>
            </div>
        </div>
    {% endif %}
    <!-- end Resoluciones-->
    </div>
    </div>
    <!-- Begin Modal de crear documentos cerrados-->
    <div class="modal fade modal-dialog-full-screen modal-content-full-screen" id="agregar_acta_cerrada" tabindex="-1"
         role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-full-screen modal-content-full-screen">
            <!-- Begin Modal content -->
            <div class="modal-content">
                <form id="" class="" action="{% url "crear_nueva_acta_fiscalizacion" fiscalizacion.id %}" method="post">
                    <!-- Begin Modal header -->
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">[[tipo_acta]]</h4>
                    </div>
                    <!-- End Modal header -->
                    <!-- Begin Modal body -->
                    <div class="modal-body">
                        {% csrf_token %}
                        <input class="form-control no-border " type="hidden" name="codigo_objeto" readonly
                               value="{{ fiscalizacion.id }}"/>

                        <!-- start campos del formulario -->
                        <div class="row form-group">
                            <div class="col-xs-2">
                                <label class="labelmodal">Número de documento</label>
                            </div>
                            <div class="input-group col-xs-5">
                                <input class="form-control " type="text" name="codigo_acta" readonly
                                       value="[[codigo]]"/>
                            </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-xs-2">
                                <label class="labelmodal">Tipo de documento</label>
                            </div>
                            <div class="input-group col-xs-5">
                                <input class="form-control" type="text" name="tipo_acta" readonly
                                       value="[[tipo_acta]]"/>
                            </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-xs-2 ">
                                <label class="labelmodal">Fecha de notificación</label>
                            </div>
                            <div class="input-group col-xs-5">
                                <input class="form-control fecha" type="text" id="fecha_creacion"
                                       name="fecha_notificacion_acta" value="" data-date-format="dd/mm/yyyy"/>
                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            </div>
                        </div>
                        <!-- end campos del formulario -->
                        <br>
                        <!-- Begin header listado -->
                        <div class="row">
                            <div class="col-xs-12">
                                <h3>
                                    Lista de requisitos
                                </h3>
                            </div>
                        </div>
                        <!-- End  header listado-->

                        <!-- Begin lista de requisitos seleccionables si es un acta de requerimientos cerrada -->
                        <div ng-if="solo_lista == true ">
                            <div class="row">
                                <div class="col-xs-12">
                                    <table class="table table-striped">
                                        <thead>
                                        <tr>
                                            <th class="">Requisito</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="requisito in requisitos"
                                            ng-init="data = { id: requisito.id, activo: requisito.activo, nombre: requisito.nombre}">
                                            <td>[[ data.nombre ]]</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!-- End lista de requisitos seleccionables si es un acta de requerimientos cerrada -->

                        <!-- Begin lista de requisitos seleccionables si es un acta de recepcion cerrada -->
                        <div ng-if="solo_lista == false ">
                            <div class="row">
                                <div class="col-xs-12">
                                    <table class="table table-striped">
                                        <thead>
                                        <tr>
                                            <th class="">Requisito</th>
                                            <th class="">¿Entregó?</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr class="" ng-repeat="requisito in requisitos"
                                            ng-init="data = { id: requisito.id, activo: requisito.activo, nombre: requisito.nombre}">
                                            <td class="">
                                                <p>[[ data.nombre ]]</p>
                                            </td>
                                            <td>
                                                <input type="checkbox" class="validar" data-id-requisito="[[ data.id ]]"
                                                       id="[[ data.id ]]" name="requisito[[ data.id ]]"
                                                       ng-checked="[[ data.activo ]]"/>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!-- End lista de requisitos seleccionables si es un acta de recepcion cerrada -->

                    </div>
                    <!-- End Modal body -->
                    <!-- Begin Modal footer -->
                    <div class="modal-footer">
                        <div class="row">
                            <div class="col-xs-6">
                                <button type="submit" class="btn btn-primary btn-block btn-flat">Guardar acta</button>
                            </div>
                            <div class="col-xs-6">
                                <button type="button" class="btn btn-danger btn-block btn-flat"
                                        data-dismiss="modal">
                                    Cancelar
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- End Modal footer -->
                </form>
            </div>
            <!-- End Modal content -->
        </div>
    </div>
    <!-- End Modal de crear documentos cerrados -->

    <!-- Begin Modal de crear documentos -->
    <div class="modal fade" id="agregar_acta" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form role="form" action="{% url "crear_nueva_acta_fiscalizacion" fiscalizacion.id %}" method="post">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">[[tipo_acta]]</h4>
                    </div>
                    <div class="modal-body">
                        {% csrf_token %}
                        <input type="hidden" name="codigo_objeto" readonly value="{{ fiscalizacion.id }}"/>
                        <!-- Begin Campos del formulario -->
                        <div class="row form-group">
                            <div class="col-xs-4 text-right">
                                <label class="labelmodal">Número de documento</label>
                            </div>
                            <div class="input-group  col-xs-8">
                                <input class="form-control no-border " type="text" name="codigo_acta" readonly
                                       value="[[codigo]]"/>
                            </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-xs-4 text-right">
                                <label class="labelmodal">Tipo de documento</label>
                            </div>
                            <div class="input-group col-xs-8">
                                <input class="form-control no-border " type="text" name="tipo_acta" readonly
                                       value="[[tipo_acta]]"/>
                            </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-xs-4 text-right">
                                <label class="labelmodal">Fecha de notificación</label>
                            </div>
                            <div class="input-group col-xs-8">
                                <input class="form-control fecha" type="text" data-date-format="dd/mm/yyyy"
                                       id="fecha_creacion"
                                       name="fecha_notificacion_acta" value=""/>
                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            </div>
                        </div>
                        <!-- End Campos del formulario -->
                        <div class="row form-group">
                            <div class="col-xs-4 text-right">
                                <label>Observaciones</label>
                            </div>
                            <div class="input-group col-xs-8">
                                <textarea class="form-control" rows="5" name="observaciones_acta"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div class="row">
                            <div class="col-xs-6">
                                <button type="submit" class="btn btn-primary btn-block btn-flat">Guardar</button>
                            </div>
                            <div class="col-xs-6">
                                <button type="button" class="btn btn-danger btn-block btn-flat"
                                        data-dismiss="modal">
                                    Cancelar
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- End Modal de crear documentos -->

    <!-- Begin Modal de editar documentos con requisitos-->
    <div class="modal fade" id="editar_acta_requisitos" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-full-screen modal-content-full-screen">
            <div class="modal-content">
                <form class="" role="form" action="{% url "editar_nueva_acta_fiscalizacion" fiscalizacion.id %}"
                      method="post">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">[[tipo_editar]]</h4>
                    </div>
                    <div class="modal-body">
                        {% csrf_token %}
                        <input class="form-control no-border " type="hidden" name="codigo_objeto" readonly
                               value="{{ fiscalizacion.id }}"/>
                        <!-- Begin campos del formulario -->
                        <div class="row form-group">
                            <div class="col-xs-2">
                                <label class="labelmodal">Número de documento</label>
                            </div>
                            <div class="input-group  col-xs-5">
                                <input class="form-control " type="text" name="codigo_acta" readonly
                                       value="[[codigo_editar]]"/>
                            </div>
                        </div>
                        <div class="row  form-group">
                            <div class="col-xs-2">
                                <label class="labelmodal">Tipo de documento</label>
                            </div>
                            <div class="input-group col-xs-5">
                                <input class="form-control" type="text" name="tipo_acta" readonly
                                       value="[[tipo_editar]]"/>
                            </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-xs-2 ">
                                <label class="labelmodal">Fecha de notificación</label>
                            </div>
                            <div class="input-group col-xs-5">
                                <input class="form-control fecha" type="text" data-date-format="dd/mm/yyyy"
                                       id="fecha_edicion"
                                       name="fecha_notificacion_acta" required="required"
                                       value="[[fecha_notificacion_editar]]"/>
                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            </div>
                        </div>
                        <!-- End campos de formulario -->
                        <!-- Begin listado de requisitos  -->
                        <div class="row">
                            <div class="col-xs-12">
                                <h3>
                                    Lista de requisitos
                                </h3>
                            </div>
                        </div>
                        <div ng-if="solo_lista == true ">
                            <div class="row">
                                <div class="col-xs-12">
                                    <table class="table table-striped">
                                        <thead>
                                        <tr>
                                            <th class="">Requisito</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="requisito in requisitos"
                                            ng-init="data = { id: requisito.id, activo: requisito.activo, nombre: requisito.nombre}">
                                            <td>[[ data.nombre ]]</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div ng-if="solo_lista == false ">
                            <div class="row">
                                <div class="col-xs-12">
                                    <table class="table table-striped">
                                        <thead>
                                        <tr>
                                            <th class="">Requisito</th>
                                            <th class="">¿Entregó?</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="requisito in requisitos"
                                            ng-init="data = { id: requisito.id, activo: requisito.activo, nombre: requisito.nombre}">
                                            <td>
                                                <p class="">
                                                    [[ data.nombre ]]
                                                </p>
                                            </td>

                                            <td>
                                                <input
                                                        type="checkbox"
                                                        class="validar form-control"
                                                        data-id-requisito="[[ data.id ]]"
                                                        id="[[ data.id ]]"
                                                        name="requisito[[ data.id ]]"
                                                        ng-checked="[[ data.activo ]]"
                                                        />
                                            </td>

                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!-- End listado de requisitos -->
                    </div>
                    <div class="modal-footer">
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="col-xs-6">
                                    <button type="submit" class="btn btn-primary btn-block btn-flat">Editar</button>
                                </div>
                                <div class="col-xs-6">
                                    <button type="button" class="btn btn-danger btn-block btn-flat"
                                            data-dismiss="modal">
                                        Cancelar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- End Modal de editar documentos con requisitos-->

    <!-- Begin Modal de editar documentos -->
    <div class="modal fade" id="editar_acta" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form class="form-horizontal" role="form"
                      action="{% url "editar_nueva_acta_fiscalizacion" fiscalizacion.id %}" method="post">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">[[tipo_editar]]</h4>
                    </div>
                    <div class="modal-body">
                        {% csrf_token %}
                        <input type="hidden" name="codigo_objeto" readonly value="{{ fiscalizacion.id }}"/>

                        <div class="row form-group">
                            <div class="col-xs-4">
                                <label class="labelmodal">Número de documento</label>
                            </div>
                            <div class="input-group  col-xs-8">
                                <input class="form-control" type="text" name="codigo_acta" readonly
                                       value="[[codigo_editar]]"/>
                            </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-xs-4">
                                <label class="labelmodal">Tipo de documento</label>
                            </div>
                            <div class="input-group col-xs-8">
                                <input class="form-control no-border " type="text" name="tipo_acta" readonly
                                       value="[[tipo_editar]]"/>
                            </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-xs-4">
                                <label class="labelmodal">Fecha de notificación</label>
                            </div>
                            <div class="input-group col-xs-8">
                                <input class="form-control fecha" type="text" data-date-format="dd/mm/yyyy"
                                       id="fecha_edicion"
                                       name="fecha_notificacion_acta" required="required"
                                       value="[[fecha_notificacion_editar]]"/>
                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-xs-4">
                                <label class="labelmodal">Observaciones</label>
                            </div>
                            <div class="col-xs-8">
                                <textarea class="form-control" name="observaciones_acta"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div class="row">
                            <div class="col-xs-6">
                                <button type="submit" class="btn btn-primary btn-block btn-flat">Editar</button>
                            </div>
                            <div class="col-xs-6">
                                <button type="button" class="btn btn-danger btn-block btn-flat"
                                        data-dismiss="modal">
                                    Cancelar
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- End Modal de editar documentos -->

    <!-- Begin Modal de ver documentos con requisitos -->
    <div class="modal fade modal-dialog-full-screen modal-content-full-screen" id="ver_acta_requisitos" tabindex="-1"
         role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-full-screen modal-content-full-screen">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">[[tipo_ver]]</h4>
                </div>
                <div class="modal-body">
                    <div class="row form-group">
                        <div class="col-xs-2">
                            <label class="labelmodal">Número de documento</label>
                        </div>
                        <div class="input-group col-xs-5">
                            <input class="form-control" type="text" name="tipo_acta" readonly value="[[codigo_ver]]"/>
                        </div>
                    </div>
                    <div class="row form-group">
                        <div class="col-xs-2">
                            <label class="labelmodal">Tipo de documento</label>
                        </div>
                        <div class="input-group col-xs-5">
                            <input class="form-control" type="text" name="tipo_acta" readonly value="[[tipo_ver]]"/>
                        </div>
                    </div>
                    <div class="row form-group">
                        <div class="col-xs-2">
                            <label class="labelmodal">Fecha de notificación</label>
                        </div>
                        <div class="input-group col-xs-5">
                            <input class="form-control" type="text" name="tipo_acta" readonly
                                   value="[[fecha_notificacion_ver]]"/>
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        </div>
                    </div>


                    <div class="row">
                        <div class="col-xs-12">
                            <h3>
                                Lista de requisitos
                            </h3>
                        </div>
                    </div>
                    <br/>

                    <div ng-if="solo_lista == true ">
                        <div class="row">
                            <div class="col-xs-12">
                                <table class="table table-striped">
                                    <thead>
                                    <tr>
                                        <th class="">Requisito</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-repeat="requisito in requisitos"
                                        ng-init="data = { id: requisito.id, activo: requisito.activo, nombre: requisito.nombre}">
                                        <td>[[ data.nombre ]]</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div ng-if="solo_lista == false ">
                        <div class="row">
                            <div class="col-xs-12">
                                <table class="table table-striped">
                                    <thead>
                                    <tr>
                                        <th>Requisito</th>
                                        <th>¿Entregó?</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-repeat="requisito in requisitos"
                                        ng-init="data = { id: requisito.id, activo: requisito.activo, nombre: requisito.nombre}">
                                        <td>
                                            [[ data.nombre ]]
                                        </td>
                                        <td>
                                            <input type="checkbox" class="validar" data-id-requisito="[[ data.id ]]"
                                                   id="[[ data.id ]]" name="requisito[[ data.id ]]"
                                                   ng-checked="[[ data.activo ]]" disabled/>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-xs-6 col-xs-offset-6">
                            <button type="button" class="btn btn-danger btn-block btn-flat" data-dismiss="modal">
                                Cerrar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Modal de ver documentos con requisitos -->

    <!-- Begin Modal de ver documentos -->
    <div class="modal fade" id="ver_acta" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">[[tipo_ver]]</h4>
                </div>
                <div class="modal-body">
                    <div class="row form-group">
                        <div class="col-xs-4 text-right">
                            <label class="labelmodal">Número de documento</label>
                        </div>
                        <div class="input-group col-xs-8">
                            <input class="form-control" type="text" name="tipo_acta" readonly
                                   value="[[codigo_ver]]"/>
                        </div>
                    </div>
                    <div class="row form-group">
                        <div class="col-xs-4 text-right">
                            <label class="labelmodal">Tipo de documento</label>
                        </div>
                        <div class="input-group col-xs-8">
                            <input class="form-control" type="text" name="tipo_acta" readonly
                                   value="[[tipo_ver]]"/>
                        </div>
                    </div>
                    <div class="row form-group">
                        <div class="col-xs-4 text-right">
                            <label class="labelmodal">Fecha de notificación</label>
                        </div>
                        <div class="input-group col-xs-8">
                            <input class="form-control" type="text" name="tipo_acta" readonly
                                   value="[[fecha_notificacion_ver]]"/>
                            <span class="input-group-addon"><i class="fa fa-ambulance"></i></span>
                        </div>
                    </div>
                    <div class="row form-group">
                        <div class="col-xs-4 text-right">
                            <label class="labelmodal">Observaciones</label>
                        </div>
                        <div class="input-group col-xs-8">
                            <textarea cols="30"
                                      rows="7" class="form-control" name="tipo_acta"
                                      readonly>[[observaciones_ver]]</textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-xs-6 col-xs-offset-6">
                            <button type="button" class="btn btn-danger btn-block btn-flat"
                                    data-dismiss="modal">
                                Cancelar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Modal de ver documentos -->

    <!-- Modal de anular providencia -->
    <div class="modal fade" id="anular_providencia" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form class="form-horizontal"
                      role="form"
                      action="{% url "anular_providencia_acta_fiscalizacion" fiscalizacion.id %}"
                      method="post">{% csrf_token %}
                    <div class="modal-header" style="background-color: #E74F4C; color: white;">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">Solicitud de Anulación de Providencia</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-xs-12">
                                <label>Justificación:</label>
                                <textarea
                                        name="justificacion"
                                        class="form-control"
                                        rows="3"></textarea>
                                <input type="hidden"
                                       name="codigo_providencia"
                                       value="[[ codigo_providencia ]]"/>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <div class="row">
                            <div class="col-xs-6">
                                <input type="submit"
                                       value="Aceptar"
                                       class="btn btn-primary btn-block btn-flat"/>
                            </div>
                            <div class="col-xs-6">
                                <button type="button" class="btn btn-danger btn-block btn-flat" data-dismiss="modal">
                                    Cancelar
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Begin Modal de editar resoluciones -->
    <!-- End Modal de editar resoluciones -->


    <!-- Modal de mensaje de advertencia al momento de agregar un acta -->
    <div class="modal fade" id="advertencia_seleccionar_acta" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background: #E74F4C; color: white;">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Atención</h4>
                </div>
                <div class="modal-body text-center">
                    <div class="row">
                        <div class="col-xs-12">
                            <span class="bg-danger">Debe seleccionar un tipo de acta</span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-xs-12">
                            <button type="button" class="btn btn-danger btn-block btn-flat" data-dismiss="modal">
                                Ok
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para la conclusión de la fiscalización -->
    <div id="fiscalizacion-concluir-modal" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background: #E74F4C; color: white;">
                    <button type="button" class="close" data-dismiss="modal"><span
                            aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">Concluir fiscalización</h4>
                </div>
                <div class="modal-body">
                    <p>¿Se encontraron irregularidades durante el proceso de fiscalización?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal"
                            data-target="#fiscalizacion-conclusion-observaciones-modal" data-toggle="modal"
                            style="min-width:100px;">No
                    </button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal"
                            data-target="#nueva-acta-reparo-modal" data-toggle="modal" style="min-width:100px;">Si
                    </button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->

    <div id="fiscalizacion-conclusion-observaciones-modal" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background: #E74F4C; color: white;">
                    <button type="button" class="close" data-dismiss="modal"><span
                            aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">Conclusiones y observaciones del proceso de fiscalización</h4>
                </div>
                <div class="modal-body">
                    <label>Ingrese las conclusiones del proceso:</label><br>
                    <textarea name="conclusiones" rows="5" style="width: 100%"></textarea>
                    <br>
                    <br>
                    <label>Ingrese las observaciones del proceso (serán enviadas al PST vía correo electrónico):</label><br>
                    <textarea name="observaciones" rows="5" style="width: 100%"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Guardar</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->

    <div id="nueva-acta-reparo-modal" class="modal fade" ng-controller="NuevaActaReparoCtrl">
        <div class="modal-dialog"
             ng-init="populatePeriodos('{{ fiscalizacion.desde|date:"Y-m-d" }}', '{{ fiscalizacion.hasta|date:"Y-m-d" }}')">
            <div class="modal-content">
                <div class="modal-header" style="background: #E74F4C; color: white;">
                    <button type="button" class="close" data-dismiss="modal"><span
                            aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">Nueva acta de reparo</h4>
                </div>
                <div class="modal-body">
                    {% csrf_token %}

                    <div class="row">
                        <div class="col-xs-4">
                            <strong>Número de documento:</strong>
                        </div>
                        <div class="col-xs-8">
                            <input class="form-control" type="text" name="acta-numero-documento" readonly
                                   value="<Por generar>">
                        </div>
                    </div>

                    <br>

                    <div class="row">
                        <div class="col-xs-4">
                            <strong>Fecha de notificación:</strong>
                        </div>
                        <div class="col-xs-8 input-append date">
                            <div class="input-group input-append date" data-date-format="dd/mm/yyyy"
                                 data-date-start-date="+15d">
                                <input class="form-control date-mask" type="text" name="acta-fecha-notificacion">
                                <span class="input-group-addon add-on" style="padding: 2px 10px;"><i
                                        class="fa fa-calendar"></i></span>
                            </div>
                        </div>
                    </div>

                    <br> <br>

                    <table class="table table-striped table-condensed text-center">
                        <thead>
                        <tr>
                            <th>Periodo</th>
                            <th>Ingresos brutos según fiscalización</th>
                            <th>Cálculo 1% según fiscalización</th>
                            <th>Monto pagado según declaración</th>
                            <th>Diferencia por pagar</th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr ng-repeat="periodo in periodos">
                            <td>
                                [[periodo.periodo]]
                            </td>
                            <td>
                                <input class="form-control decimal-mask text-center" type="text"
                                       ng-if="periodo.readonly" readonly ng-model="periodo.ingresos_brutos">
                                <input class="form-control decimal-mask text-center" type="text"
                                       ng-if="!periodo.readonly" ng-model="periodo.ingresos_brutos">
                            </td>
                            <td>
                                [[periodo.calculo_segun_fiscalizacion]]
                            </td>
                            <td>
                                [[periodo.monto_pagado_segun_declaracion]]
                            </td>
                            <td>
                                [[periodo.diferencia_por_pagar]]
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" ng-click="guardarNuevaActaReparo()">Guardar</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

    <div id="editar-acta-reparo-modal" class="modal fade" ng-controller="EditarActaReparoCtrl">
        <div class="modal-dialog" ng-init="populateActa({{ fiscalizacion.pk }})">
            <div class="modal-content">
                <div class="modal-header" style="background: #E74F4C; color: white;">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">Editar acta de reparo</h4>
                </div>
                <div class="modal-body">
                    {% csrf_token %}

                    <div class="row">
                        <div class="col-xs-4">
                            <strong>Número de documento:</strong>
                        </div>
                        <div class="col-xs-8">
                            <input class="form-control" type="text" name="acta-numero-documento" readonly value="[[acta.fields.codigo]]">
                        </div>
                    </div>

                    <br>

                    <div class="row">
                        <div class="col-xs-4">
                            <strong>Fecha de notificación:</strong>
                        </div>
                        <div class="col-xs-8 input-append date">
                            <div class="input-group input-append date" data-date-format="dd/mm/yyyy" data-date-start-date="+15d">
                                <input class="form-control date-mask" type="text" name="acta-fecha-notificacion" ng-model="acta.fields.fecha_notificacion">
                                <span class="input-group-addon add-on" style="padding: 2px 10px;"><i class="fa fa-calendar"></i></span>
                            </div>
                        </div>
                    </div>

                    <br> <br>

                    <table class="table table-striped table-condensed text-center">
                        <thead>
                        <tr>
                            <th>Periodo</th>
                            <th>Ingresos brutos según fiscalización</th>
                            <th>Cálculo 1% según fiscalización</th>
                            <th>Monto pagado según declaración</th>
                            <th>Diferencia por pagar</th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr ng-repeat="atributo in acta.atributo_list">
                            <td>
                                [[atributo.fields.periodo]]
                            </td>
                            <td>
                                <input class="form-control decimal-mask text-center" type="text"  ng-model="atributo.fields.ingresos_brutos">
                            </td>
                            <td>
                                [[atributo.fields.calculo_segun_fiscalizacion]]
                            </td>
                            <td>
                                [[atributo.fields.monto_pagado_segun_declaracion]]
                            </td>
                            <td>
                                [[atributo.fields.diferencia_por_pagar]]
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" ng-click="guardarActaReparo()">Guardar</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
    </div>
    </section>
    </aside>
    </div>
{% endblock %}
